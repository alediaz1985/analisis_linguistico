<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Asistente de Traducci√≥n y Categorizaci√≥n</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'asistente/css/estilo.css' %}">
</head>
<body>
    <h1>Asistente de Traducci√≥n y Categorizaci√≥n de Palabras</h1>
    <form action="{% url 'analizar' %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <label for="texto">Ingrese texto:</label>
        <textarea id="texto" name="texto" rows="4" cols="50"></textarea>
        <button type="button" onclick="activarDictado()">üéôÔ∏è Dictar</button>
        <br><br>

        <label for="audio">Subir archivo de audio:</label>
        <input type="file" name="audio" accept="audio/*"><br><br>

        <label for="archivo_texto">Subir archivo de texto:</label>
        <input type="file" name="archivo_texto" accept=".txt"><br><br>

        <button type="submit">Analizar</button>
    </form>

    {% if pasos %}
        <h2>Progreso del An√°lisis:</h2>
        <ol>
            {% for paso in pasos %}
                <li>{{ paso }}</li>
            {% endfor %}
        </ol>
    {% endif %}

    {% if resultado %}
        <h2>Texto Analizado:</h2>
        <p><strong>Original:</strong> {{ resultado.texto }}</p>
        <p><strong>Traducido:</strong> {{ resultado.texto_traducido }}</p>

        <h2>Categor√≠as L√©xicas y Traducci√≥n de Sin√≥nimos:</h2>
        <ul>
            {% for palabra, info in resultado.categorias.items %}
                <li>{{ palabra }}: Sin√≥nimos: {{ info.sinonimos|join:", " }}</li>
            {% endfor %}
        </ul>
    {% endif %}

    <script>
        function activarDictado() {
            if (!('webkitSpeechRecognition' in window)) {
                alert("Tu navegador no soporta el reconocimiento de voz.");
                return;
            }

            const recognition = new webkitSpeechRecognition();
            recognition.lang = "es-ES";
            recognition.onresult = function(event) {
                const texto = event.results[0][0].transcript;
                document.getElementById("texto").value += texto;
            };
            recognition.start();
        }
    </script>
</body>
</html>
